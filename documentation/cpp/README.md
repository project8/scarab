# Scarab/documentation

This directory contains the files necessary to setup automated documentation for a C++ project.  
If you are here for that purpose, rather than looking at Scarab-specific documentation, ignore files that start with `Scarab_`.

The documentation system will create a documentation website hosted and automatically generated by readthedocs.org (RTD).
You will be able to access the documentation at these URLs:
* www.project8.org/[github repo name]
* [RTD project name].readthedocs.io
* [RTD project name].rtfd.io

The software stack used to generate the documentation is:
* Doxygen -- C++ source parsing and API website generation
* Sphinx -- Python-based documentation website generation
* readthedocs.org -- Website generation and hosting


## Instructions for setting up documentation for a C++ project.

### In your project repo
1. Create a documentation directory.
1. Copy into it the files `index.rst` and `conf.py`.  You do not need to copy `requirements.txt` or `Doxyfile`.
1. Create a `doxfiles` or `DoxFiles` directory in your documentation directory, and copy `doxfiles/mainpage.dox` into it.
1. If you have rst documentation files, put them in the documentation directory; otherwise it's recommended to create a placeholder rst file for use or descriptive documentation.
1. Put the filename(s) for any rst documentation files (minus .rst extension) in `_index.rst` after the initial lines defining the table of contents.
1. Customize `index.rst` and `conf.py` with the name and description of your project.
1. Customize `conf.py` with the relevant directories in your project (`DOXYGEN_INPUT`, `DOXYGEN_EXCLUDE`, and `PREPROC_INCLUDE_PATH`).
1. If you have a favicon file, put it in the documentation directory and specify it in `conf.py`; otherwise comment out the `html_favicon` variable in that file.
1. Recommendation: don't merge these changes into the main branch just yet; test the creation of the documentation (described below) first.

### On readthedocs
1. Create an RTD project for your software project by importing from GitHub (this will automatically create a webhook directed to RTD).
1. As you change each settings in each category below, be sure to press the Submit button so the changes are saved.
1. Under Admin:Settings, change the programming language to C++.
1. Under Admin:Advanced Settings:
    1. Specify the location of the requirements.txt file (in Scarab) under "Requirements file".
    1. Specify the location of conf.py under "Python configuration file".
    1. Specify the branch where your documentation currently resides as "Default branch".
1. Under Admin:Maintainers, add Noah as an additional maintainer so we can maintain access if you're unavailable.
1. Under Builds you should see the `latest` build building.  Once it's done, check the documentation to make sure it worked.  If it worked great, carry on. If not, go back and fix whatever's wrong.
1. Under Admin:Advanced Settings, switch the "Default branch" to `main`.

### In your project repo
1. Merge your changes to the main branch with a new release; this should trigger a new build of the documentation, which you should then go and check.
1. If it doesn't already exist, create an orphan branch in your repo called `gh-pages` and clear it of all files.
1. Populate the `gh-pages` branch with an empty file called `.nojekyll` and the following in `index.html`:
    ```
    <html>
        <head>
            <meta http-equiv="refresh" content="0; url=https://scarab.readthedocs.io/">
        </head>
    </html>
    ```
    with your RTD project name replacing `scarab`.
1. Commit and push `gh-pages` to GitHub.
1. In the settings for your repo, under GitHub Pages, make sure that the Source drop-down menu has `gh-pages` selected.
1. Check that if you go to `http://www.project8.org/[github repo name]` it redirects to the RTD documentation.
